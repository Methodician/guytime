<mat-toolbar id='chat-detail-toolbar'>
  <button
    (click)='onBackClicked()'
    class='back_button'
    mat-icon-button
    aria-label='Back Button'
  >
    <mat-icon>arrow_back</mat-icon>
  </button>
  <div class='avatar-container' *ngIf="users && users.length > 0">
    <gtm-avatar
      [fileName]='avatarFileName$(users[0].uid) | async'
      imageSize='45x45'
    ></gtm-avatar>
  </div>
  <span class='page_title'>{{ firstNames }}</span>

</mat-toolbar>
<section class="chat_list" #chatList>
  <gtm-chat-message
    *ngFor="let message of messages$ | async; trackBy: trackMessageBy"
    [chatMessage]="message"
  >
  </gtm-chat-message>
  <div
    class="not-connected-message"
    *ngIf="group && group.isPairChat && isIncomingChatRequest() && isInitiatedByLoggedInUser()"
  >
    <span>You and {{firstNames}} are not connected</span>
    <span>Waiting for {{firstNames}} to respond ...</span>
  </div>
</section>

<section
  class="chat_input_wrapper not_connected"
  *ngIf="group && group.isPairChat && isIncomingChatRequest() && !isInitiatedByLoggedInUser()"
>
  <span>You and {{firstNames}} are not connected</span>
  <div class="button-container">
    <button
      mat-stroked-button
      aria-label="Ignore"
      (click)="onIgnoreUser()"
    >
      Ignore
    </button>
    <button
      mat-stroked-button
      color='primary'
      aria-label="Add connection"
      (click)="onAddConnection()"
    >
      Add Connection
    </button>
  </div>
</section>

<section
  class="chat_input_wrapper"
  *ngIf="!group || !group.isPairChat || isInitiatedByLoggedInUser() || !isIncomingChatRequest()"
>
  <form action="submit">
    <textarea
      #chatInput
      class='chat_input mat-body'
      name='msgInput'
      (input)='onTextareaChange()'
      placeholder='Say something...'
      [(ngModel)]='msgInput'
      [ngClass]='{ chat_input_has_text: msgInput.length > 0 }'
    ></textarea>
  </form>
  <button
    aria-label="Send Message"
    mat-mini-fab
    color='primary'
    class="send_button"
    (click)="onSendMessage()"
  >
    <mat-icon>send</mat-icon>
  </button>
</section>
